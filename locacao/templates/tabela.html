{% include "header.html" %}
{% load static %}
  <body>
    <script src="{% static 'js/jquery.js' %}"></script>
  	<script src="{% static 'js/angular.min.js' %}"></script>
	<script src="{% static 'js/cookie.js' %}"></script>
	<script>
		var app = angular.module('myapp', []);
		app.config(function($interpolateProvider) {
		$interpolateProvider.startSymbol('{[{');
		$interpolateProvider.endSymbol('}]}');
		});
		'use strict';
		app.controller('tabelaCtrl', function($scope, $http) {	
			$http.defaults.xsrfCookieName = 'csrftoken';
			$http.defaults.xsrfHeaderName = 'X-CSRFToken';
			$http.get("{% url consultaURL %}").then(function(response) {
				$scope.myData = response.data;
			});
			$scope.deleteRecord = function(docURL){
				console.log( "{% url consultaURL %}" +docURL);
				$http.delete( "{% url consultaURL %}" +docURL);
				location.reload();
				
			}
		});
	</script>
  
  <!-- container section start -->
  <section id="container" class="">
      <!--header start-->
	{% include "sidebar.html" %}
      <!--main content start-->
      <section id="main-content">
          <section class="wrapper">
		  <div class="row">
				<div class="col-lg-11">
					<h3 class="page-header">
						<i class="fa fa-table"></i> Tabela de {{titulo}}
						<a class="btn btn-primary btn-sm" href="cadastro/" title="Cadastrar {{titulo}}">Cadastrar {{titulo}}</a>
					</h3>
					<ol class="breadcrumb">
						<li><i class="fa fa-home"></i><a href="index.html">Principal</a></li>
						<li><i class="fa fa-table"></i>Tabela de {{titulo}}</li>
					</ol>
				</div>
			</div>
                  <div class="col-sm-12" ng-app="myapp">
                      <section class="panel">
                          <header class="panel-heading">
                              {{ titulo }} Cadastrados
                          </header>
                          <table class="table table-hover" ng-controller="tabelaCtrl">
                              <thead>
                              <tr>
                                  <th>#</th>
								  {% for texto in listaTabela %}
									<th>{{texto}}</th>
                                  {% endfor %}
								  <th>Ações</th>
                              </tr>
                              </thead>
                              <tbody >
								  <tr ng-repeat="x in myData">
										<td ng-repeat="y in x">{[{ y }]}</td>
										<td>
											<a class="btn btn-danger btn-sm" href="#" ng-click='deleteRecord(x.id)' title="Remover">
												<span class="icon_trash"></span>
											</a>
											<a class="btn btn-primary btn-sm" href="altera/{[{x.id}]}" title="Remover">
												<span class="icon_folder"></span>
											</a>
										</td>
								  </tr>
                              </tbody>
                          </table>
                      </section>
                  </div>
              </div>
          </section>
      </section>
      <!--main content end-->
  </section>
  <!-- container section end -->
    <!-- javascripts -->

    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <!-- nicescroll -->
    <script src="{% static 'js/jquery.scrollTo.min.js' %}"></script>
    <script src="{% static 'js/jquery.nicescroll.js' %}" type="text/javascript"></script>
    <!--custome script for all page-->
    <script src="{% static 'js/scripts.js' %}"></script>


  </body>
</html>
